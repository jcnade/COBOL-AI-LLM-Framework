IDENTIFICATION DIVISION.
PROGRAM-ID. UTILS.
AUTHOR. Jean-Charles Nad√©.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  WS-STRING            PIC X(100).
01  WS-REVERSED-STRING   PIC X(100).
01  WS-TEMP              PIC X(100).
01  WS-LENGTH            PIC 9(5).
01  WS-INDEX             PIC 9(5).

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY 'UTILS module loaded.'.
    STOP RUN.

* Reverses a given string
REVERSE-STRING.
    MOVE SPACES TO WS-REVERSED-STRING.
    COMPUTE WS-LENGTH = FUNCTION LENGTH(WS-STRING).
    PERFORM VARYING WS-INDEX FROM WS-LENGTH BY -1 UNTIL WS-INDEX < 1
        MOVE WS-STRING(WS-INDEX:1) TO WS-TEMP
        STRING WS-TEMP DELIMITED BY SIZE INTO WS-REVERSED-STRING
    END-PERFORM.
    DISPLAY 'Original String: ' WS-STRING.
    DISPLAY 'Reversed String: ' WS-REVERSED-STRING.
    EXIT.

* Converts a string to uppercase
TO-UPPERCASE.
    MOVE FUNCTION UPPER-CASE(WS-STRING) TO WS-STRING.
    DISPLAY 'Uppercase String: ' WS-STRING.
    EXIT.

END PROGRAM UTILS.
