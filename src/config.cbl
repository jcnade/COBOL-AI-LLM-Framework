IDENTIFICATION DIVISION.
PROGRAM-ID. CONFIG.
AUTHOR. Jean-Charles Nad√©.

ENVIRONMENT DIVISION.
CONFIGURATION SECTION.
SOURCE-COMPUTER. IBM-370.
OBJECT-COMPUTER. IBM-370.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  WS-CONFIG-FILE      PIC X(30)  VALUE 'config.dat'.
01  WS-CONFIG-RECORD.
    05  WS-MAX-TOKENS   PIC 9(5)  VALUE 100.
    05  WS-MODEL-PATH   PIC X(50) VALUE 'models/default.llm'.
    05  WS-LOG-LEVEL    PIC X(10) VALUE 'INFO'.
    05  WS-THRESHOLD    PIC 9(3)V9(2) VALUE 0.75.

FILE SECTION.
FD  CONFIG-FILE
    LABEL RECORDS ARE STANDARD
    BLOCK CONTAINS 0 RECORDS
    RECORDING MODE F
    DATA RECORD IS CONFIG-REC.

01  CONFIG-REC.
    05  MAX-TOKENS      PIC 9(5).
    05  MODEL-PATH      PIC X(50).
    05  LOG-LEVEL       PIC X(10).
    05  THRESHOLD       PIC 9(3)V9(2).

PROCEDURE DIVISION.
MAIN-PARA.
    DISPLAY 'Loading configuration...'.
    OPEN INPUT CONFIG-FILE.
    READ CONFIG-FILE INTO CONFIG-REC
        AT END
            DISPLAY 'End of configuration file reached.'
            MOVE WS-MAX-TOKENS TO MAX-TOKENS
            MOVE WS-MODEL-PATH TO MODEL-PATH
            MOVE WS-LOG-LEVEL TO LOG-LEVEL
            MOVE WS-THRESHOLD TO THRESHOLD
        NOT AT END
            MOVE CONFIG-REC TO WS-CONFIG-RECORD
    END-READ.
    CLOSE CONFIG-FILE.
    DISPLAY 'Configuration Loaded:'.
    DISPLAY 'MAX-TOKENS: ' MAX-TOKENS.
    DISPLAY 'MODEL-PATH: ' MODEL-PATH.
    DISPLAY 'LOG-LEVEL: ' LOG-LEVEL.
    DISPLAY 'THRESHOLD: ' THRESHOLD.
    STOP RUN.

END PROGRAM CONFIG.
